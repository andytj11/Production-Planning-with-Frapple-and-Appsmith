SELECT
    r.name                 AS resource,
    op.reference           AS reference,
    op.startdate::date     AS startdate,
    op.enddate::date       AS enddate
FROM   public.operationplan           op
JOIN   public.operationplanresource   opr
       ON  CAST(opr.operationplan_id AS text) = op.reference      -- or op.name if that's the PK
JOIN   public.resource                r
       ON  CAST(opr.resource_id      AS text) = r.name
WHERE  op.startdate >= '2019-06-01'
  AND  op.startdate <  '2019-07-01'
ORDER  BY r.name, op.startdate;
