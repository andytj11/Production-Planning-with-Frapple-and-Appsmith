SELECT
    opr.resource_id    AS resource,
    ROUND(SUM(EXTRACT(EPOCH FROM op.enddate - op.startdate))/3600, 2) AS hrs
FROM
    public.operationplan op
JOIN
    public.operationplanresource opr
      ON opr.operationplan_id = op.reference
WHERE
    op.startdate >= CURRENT_DATE
  AND op.startdate <  CURRENT_DATE + INTERVAL '7 day'
GROUP BY opr.resource_id
ORDER BY hrs DESC;
